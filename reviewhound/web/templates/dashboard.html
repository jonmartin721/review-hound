{% extends "base.html" %}

{% block title %}Dashboard - Review Hound{% endblock %}

{% block content %}
<h1 class="text-3xl font-bold text-gray-800 mb-6">Business Dashboard</h1>

{% if businesses %}
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
    {% for item in businesses %}
    <div class="bg-white rounded-lg shadow-md p-6 card-hover transition-all duration-200">
        <h2 class="text-xl font-semibold text-gray-800 mb-2">{{ item.business.name }}</h2>

        <div class="flex items-center mb-3">
            <span class="rating-stars text-lg">â˜…</span>
            <span class="ml-1 text-gray-700 font-medium">{{ "%.1f"|format(item.avg_rating) }}</span>
            <span class="ml-2 text-gray-500 text-sm">({{ item.total_reviews }} reviews)</span>
        </div>

        <div class="mb-4">
            <div class="flex justify-between text-xs text-gray-500 mb-1">
                <span>Sentiment</span>
                <span>{{ "%.0f"|format(item.positive_pct) }}% positive</span>
            </div>
            <div class="sentiment-bar bg-gray-200 flex">
                <div class="bg-green-500" style="width: {{ item.positive_pct }}%"></div>
                <div class="bg-red-500" style="width: {{ item.negative_pct }}%"></div>
            </div>
        </div>

        <div class="flex space-x-2 text-sm">
            {% if item.business.trustpilot_url %}
            <span class="px-2 py-1 bg-green-100 text-green-700 rounded">TrustPilot</span>
            {% endif %}
            {% if item.business.bbb_url %}
            <span class="px-2 py-1 bg-blue-100 text-blue-700 rounded">BBB</span>
            {% endif %}
            {% if item.business.yelp_url %}
            <span class="px-2 py-1 bg-red-100 text-red-700 rounded">Yelp</span>
            {% endif %}
        </div>

        <a href="{{ url_for('main.business_detail', business_id=item.business.id) }}"
           class="mt-4 block text-center bg-indigo-600 text-white py-2 rounded hover:bg-indigo-700 transition">
            View Details
        </a>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="bg-white rounded-lg shadow-md p-8 text-center">
    <p class="text-gray-500 text-lg">No businesses tracked yet.</p>
    <p class="text-gray-400 mt-2">Use the CLI to add businesses: <code class="bg-gray-100 px-2 py-1 rounded">reviewhound add "Business Name"</code></p>
</div>
{% endif %}
{% endblock %}
